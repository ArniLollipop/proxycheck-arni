(function(){"use strict";var t={9210:function(t,e,s){var r=s(2856),a=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("b-navbar",{attrs:{toggleable:"lg",type:"dark",variant:"info"}},[e("b-navbar-brand",[t._v(" Proxy Management "),e("b-badge",[t._v("v2.0")])],1),e("b-navbar-nav",[e("b-nav-item",{attrs:{to:"/"}},[t._v("Proxy")]),e("b-nav-item",{attrs:{to:"/ip_logs"}},[t._v("IP History")]),e("b-nav-item",{attrs:{to:"/speed_logs"}},[t._v("Speed History")]),e("b-nav-item",{attrs:{to:"/visit_logs"}},[t._v("Visit History")])],1)],1),e("router-view")],1)},o=[],i=s(1656),n={},l=(0,i.A)(n,a,o,!1,null,null,null),c=l.exports,p=s(1594),d=function(){var t=this,e=t._self._c;return e("div",[e("b-card",{staticClass:"m-2",attrs:{"bg-variant":"light"}},[e("ProxySettings")],1),e("b-cart",{staticClass:"m-2",attrs:{title:"Proxy List"}},[e("ProxyList")],1)],1)},u=[],f=function(){var t=this,e=t._self._c;return e("b-form",{attrs:{inline:""},on:{submit:function(e){return e.preventDefault(),t.saveSettings.apply(null,arguments)}}},[e("h4",{staticClass:"mr-3"},[t._v("Settings")]),e("label",{staticClass:"mr-1",attrs:{for:"settings-url"}},[t._v("URL For Check")]),e("b-form-input",{staticClass:"mr-2",staticStyle:{width:"200px"},attrs:{id:"settings-url",type:"text"},model:{value:t.url,callback:function(e){t.url=e},expression:"url"}}),e("label",{staticClass:"mr-1",attrs:{for:"settings-check-ip-interval"}},[t._v("CheckIP Interval")]),e("b-form-input",{staticClass:"mr-2",staticStyle:{width:"80px"},attrs:{id:"settings-check-ip-interval",type:"number"},model:{value:t.checkIPInterval,callback:function(e){t.checkIPInterval=t._n(e)},expression:"checkIPInterval"}}),e("label",{staticClass:"mr-1",attrs:{for:"settings-speed-check-interval"}},[t._v("Speed Check Interval")]),e("b-form-input",{staticClass:"mr-2",staticStyle:{width:"80px"},attrs:{id:"settings-speed-check-interval",type:"number"},model:{value:t.speedCheckInterval,callback:function(e){t.speedCheckInterval=t._n(e)},expression:"speedCheckInterval"}}),e("label",{staticClass:"mr-1",attrs:{for:"settings-username"}},[t._v("Username")]),e("b-form-input",{staticClass:"mr-2",staticStyle:{width:"120px"},attrs:{id:"settings-username",type:"text"},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}}),e("label",{staticClass:"mr-1",attrs:{for:"settings-password"}},[t._v("Password")]),e("b-form-input",{staticClass:"mr-2",staticStyle:{width:"120px"},attrs:{id:"settings-password",type:"password"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),e("b-button",{attrs:{type:"submit",variant:"primary"}},[t._v("Save")])],1)},h=[];async function m(t){const e=await t.json();if(!t.ok)throw new Error(e.error||"An unknown error occurred");return e.data}async function y(){const t=await fetch("/api/settings");return await m(t)}async function b(t){const e=await fetch("/api/settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return m(e)}var g={name:"ProxySettings",data(){return{url:"",timeout:0,checkIPInterval:0,speedCheckInterval:0,username:"",password:""}},async created(){await this.loadSettings()},methods:{async loadSettings(){try{const t=await y();console.log("Loaded settings:",t),this.url=t.url,this.timeout=t.timeout,this.checkIPInterval=t.checkIPInterval,this.speedCheckInterval=t.speedCheckInterval,this.username=t.username,this.password=t.password}catch(t){console.error("Failed to load settings:",t),alert("Failed to load settings.")}},async saveSettings(){try{const t={url:this.url,timeout:this.timeout,checkIPInterval:this.checkIPInterval,speedCheckInterval:this.speedCheckInterval,username:this.username,password:this.password};await b(t),alert("Settings saved successfully!")}catch(t){console.error("Failed to save settings:",t),alert("Failed to save settings.")}}}},x=g,v=(0,i.A)(x,f,h,!1,null,"33074530",null),w=v.exports,_=function(){var t=this,e=t._self._c;return e("div",{staticClass:"card p-3"},[e("div",{staticClass:"d-flex justify-content-between flex-wrap mb-3"},[e("b-button-group",[e("b-button",{attrs:{variant:"primary"},on:{click:t.onNew}},[t._v("New")]),e("b-button",{attrs:{variant:"secondary"},on:{click:t.onImport}},[t._v(" Import")]),e("b-button",{attrs:{variant:"success"},on:{click:t.onExport}},[t._v(" Export")]),e("b-button",{attrs:{variant:"info"},on:{click:t.onExportSelected}},[t._v(" Export Selected")]),e("b-button",{attrs:{variant:"info"},on:{click:t.onVerifySelected}},[t._v(" Verify Selected")]),e("b-button",{attrs:{variant:"danger"},on:{click:t.onDeleteSelected}},[t._v(" Delete Selected")]),e("b-button",{on:{click:t.togglePasswordVisibility}},[t._v(t._s(t.passwordsVisible?"Hide":"Show")+" Passwords")])],1),e("b-form",{attrs:{inline:""}},[e("b-input-group",{staticClass:"flex-grow-1",attrs:{size:"sm"},scopedSlots:t._u([{key:"append",fn:function(){return[e("b-input-group-text",[e("b-icon",{attrs:{icon:"search"}})],1)]},proxy:!0}])},[e("b-form-input",{attrs:{placeholder:"Search...",size:"sm"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),e("b-form-select",{staticClass:"mr-2",attrs:{options:t.portOptions,size:"sm"},model:{value:t.filters.port,callback:function(e){t.$set(t.filters,"port",e)},expression:"filters.port"}}),e("b-form-select",{staticClass:"mr-2",attrs:{options:t.operatorOptions,size:"sm"},model:{value:t.filters.operator,callback:function(e){t.$set(t.filters,"operator",e)},expression:"filters.operator"}})],1)],1),e("b-table",{ref:"selectableTable",attrs:{items:t.filteredData,fields:t.fields,"current-page":t.currentPage,"per-page":t.perPage,small:"",responsive:"sm",selectable:"","select-mode":"multi"},on:{"row-selected":t.onRowSelected},scopedSlots:t._u([{key:"cell(password)",fn:function(s){return[t.passwordsVisible?e("span",[t._v(t._s(s.item.password))]):e("span",[t._v("******")])]}},{key:"cell(lastStatus)",fn:function(s){return[1===s.item.lastStatus?e("b-badge",{attrs:{variant:"success"}},[t._v("Ok")]):2===s.item.lastStatus?e("b-badge",{attrs:{variant:"danger"}},[t._v("Error")]):3===s.item.lastStatus?e("b-badge",{attrs:{variant:"warning"}},[t._v("Stuck")]):e("span",[t._v("-")])]}},{key:"cell(uptime)",fn:function(s){return[e("span",[t._v(t._s(t.formatUptime(s.item.uptime)))])]}},{key:"cell(realIP)",fn:function(s){return[e("div",{staticClass:"d-flex justify-content-between align-items-center"},[e("span",[t._v(t._s(s.item.realIP))]),e("router-link",{attrs:{to:{path:"/ip_logs",query:{proxy_id:s.item.id}},target:"_blank"}},[e("b-button",{attrs:{size:"sm",variant:"outline-secondary"}},[e("b-icon",{attrs:{icon:"clock-history"}})],1)],1)],1)]}},{key:"cell(speed)",fn:function(s){return[e("div",{staticClass:"d-flex justify-content-between align-items-center"},[e("span",[t._v(t._s(s.item.speed))]),e("router-link",{attrs:{to:{path:"/speed_logs",query:{proxy_id:s.item.id}},target:"_blank"}},[e("b-button",{attrs:{size:"sm",variant:"outline-secondary"}},[e("b-icon",{attrs:{icon:"clock-history"}})],1)],1)],1)]}},{key:"cell(actions)",fn:function(s){return[e("router-link",{attrs:{to:{path:"/visit_logs",query:{proxy_id:s.item.id}},target:"_blank"}},[e("b-button",{staticClass:"mr-1",attrs:{size:"sm",variant:"outline-secondary"}},[e("b-icon",{attrs:{icon:"clock-history"}})],1)],1),e("b-button",{attrs:{size:"sm",variant:"warning"},on:{click:()=>t.onChange(s.item)}},[e("b-icon",{attrs:{icon:"pencil-square"}})],1),e("b-button",{attrs:{size:"sm",variant:"danger"},on:{click:()=>t.onDelete(s.item)}},[e("b-icon",{attrs:{icon:"trash"}})],1)]}},{key:"cell(selected)",fn:function({rowSelected:s}){return[s?[e("b-icon",{attrs:{icon:"check"}})]:[e("span",{attrs:{"aria-hidden":"true"}},[t._v(" ")])]]}}])}),e("div",{staticClass:"d-flex justify-content-between align-items-center mt-3"},[e("small",[t._v(t._s(t.filteredData.length)+" results")]),e("b-pagination",{attrs:{"total-rows":t.filteredData.length,"per-page":t.perPage,size:"sm"},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1),e("ProxySettingsModal",{attrs:{title:"New Proxy"},on:{"proxy-created":t.handleProxyCreated,hidden:t.onModalHidden},model:{value:t.newModalShown,callback:function(e){t.newModalShown=e},expression:"newModalShown"}}),e("ProxySettingsModal",{attrs:{title:"Edit Proxy",proxy:t.proxyToEdit},on:{"proxy-updated":t.handleProxyUpdated,hidden:t.onModalHidden},model:{value:t.editModalShown,callback:function(e){t.editModalShown=e},expression:"editModalShown"}}),e("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:t.handleFileSelected}})],1)},k=[],P=(s(8111),s(2489),s(1701),s(7642),s(8004),s(3853),s(5876),s(2475),s(5024),s(1698),function(){var t=this,e=t._self._c;return e("b-modal",{attrs:{visible:t.show,title:t.title},on:{change:e=>t.$emit("change",e),hidden:t.resetForm,ok:t.handleOk,cancel:t.handleCancel}},[e("form",{ref:"form",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[t.id?e("b-form-group",{attrs:{label:"ID:"}},[e("b-form-input",{attrs:{disabled:""},model:{value:t.id,callback:function(e){t.id=e},expression:"id"}})],1):t._e(),e("b-form-group",{attrs:{label:"IP:"}},[e("b-form-input",{attrs:{required:""},model:{value:t.ip,callback:function(e){t.ip=e},expression:"ip"}})],1),e("b-form-group",{attrs:{label:"Port:"}},[e("b-form-input",{attrs:{required:""},model:{value:t.port,callback:function(e){t.port=e},expression:"port"}})],1),e("b-form-group",{attrs:{label:"Username:"}},[e("b-form-input",{model:{value:t.username,callback:function(e){t.username=e},expression:"username"}})],1),e("b-form-group",{attrs:{label:"Password:"}},[e("b-form-input",{attrs:{type:"password"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),e("b-form-group",{attrs:{label:"Name:"}},[e("b-form-input",{model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),e("b-form-group",{attrs:{label:"Phone:"}},[e("b-form-input",{model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}})],1),e("b-form-group",{attrs:{label:"Contacts:"}},[e("b-form-textarea",{attrs:{"max-rows":"5",rows:"3"},model:{value:t.contacts,callback:function(e){t.contacts=e},expression:"contacts"}})],1)],1)])}),S=[];s(7588),s(4603),s(7566),s(8721);async function C(t){const e=await t.json();if(!t.ok)throw new Error(e.error||"An unknown error occurred");return e.data}async function I(){const t=await fetch("/api/proxy");return C(t)}async function L(t){const e=await fetch("/api/proxy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return C(e)}async function F(t,e){const s=await fetch(`/api/proxy/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return C(s)}async function D(t){const e=await fetch(`/api/proxy/${t}`,{method:"DELETE"});return C(e)}async function O(t){const e=await fetch(`/api/proxy/${t}/verify`);return C(e)}async function $(t){const e=await fetch(`/api/proxy/verify-batch?ids=${t.join(",")}`,{method:"POST"});return C(e)}async function j(t){const e=new FormData;e.append("file",t);const s=await fetch("api/import",{method:"POST",body:e}),r=await s.json();if(!s.ok)throw new Error(r.error||"Failed to import proxies");return r}async function z(t,e){if(!t.ok){const e=await t.json().catch(()=>({error:"Failed to download file"}));throw new Error(e.error)}const s=t.headers.get("Content-Disposition");let r=e;if(s&&s.includes("attachment")){const t=/filename="([^"]+)"/.exec(s);t&&t[1]&&(r=t[1])}const a=await t.blob(),o=window.URL.createObjectURL(a),i=document.createElement("a");i.style.display="none",i.href=o,i.download=r,document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(o),document.body.removeChild(i)}async function E(){const t=await fetch("/api/export/all");await z(t,"proxies.csv")}async function R(t){if(!t||0===t.length)throw new Error("No proxy IDs provided for export.");const e=await fetch(`/api/export/selected?ids=${t.join(",")}`);await z(e,"selected_proxies.csv")}async function B(t){try{const e=new URL("/api/speedLogs",window.location.origin);t&&Object.keys(t).forEach(s=>{null!==t[s]&&void 0!==t[s]&&e.searchParams.append(s,t[s])});const s=await fetch(e);return await s.json()}catch(e){throw console.error("Failed to fetch speed logs:",e),e}}async function T(t){try{const e=new URL("/api/ipLogs",window.location.origin);t&&Object.keys(t).forEach(s=>{null!==t[s]&&void 0!==t[s]&&e.searchParams.append(s,t[s])});const s=await fetch(e);return await s.json()}catch(e){throw console.error("Failed to fetch IP logs:",e),e}}async function A(t){try{const e=new URL("/api/proxyVisits",window.location.origin);t&&Object.keys(t).forEach(s=>{null!==t[s]&&void 0!==t[s]&&e.searchParams.append(s,t[s])});const s=await fetch(e);return await s.json()}catch(e){throw console.error("Failed to fetch proxy visit logs:",e),e}}var N={name:"ProxySettingsModal",model:{prop:"show",event:"change"},props:{show:{type:Boolean,default:!1},title:String,proxy:Object},watch:{proxy(t){t?(this.ip=t.ip||"",this.port=t.port||"",this.username=t.username||"",this.password=t.password||"",this.name=t.name||"",this.phone=t.phone||"",this.contacts=t.contacts||"",this.id=t.id||""):this.resetForm()}},data(){return{ip:"",port:"",username:"",password:"",name:"",phone:"",contacts:"",id:""}},methods:{resetForm(){this.ip="",this.port="",this.username="",this.password="",this.name="",this.phone="",this.contacts=""},handleOk(t){t.preventDefault(),this.handleSubmit()},handleCancel(){this.$emit("change",!1)},async handleSubmit(){const t={ip:this.ip,port:this.port,username:this.username,password:this.password,name:this.name,phone:this.phone,contacts:this.contacts};try{let e;this.proxy&&this.proxy.id?(e=await F(this.proxy.id,t),this.$emit("proxy-updated",e)):(e=await L(t),this.$emit("proxy-created",e)),this.$emit("change",!1)}catch(e){console.error("Failed to save proxy:",e),alert("Не удалось сохранить прокси. Пожалуйста, проверьте консоль для деталей.")}}}},M=N,U=(0,i.A)(M,P,S,!1,null,"02b04f99",null),V=U.exports,H={name:"ProxyList",components:{ProxySettingsModal:V},data(){return{search:"",proxies:[],selectedRows:[],newModalShown:!1,editModalShown:!1,proxyToEdit:null,pendingProxy:null,passwordsVisible:!1,filters:{port:null,operator:null},currentPage:1,perPage:100,fields:[{key:"selected",label:"",selectable:!0},{key:"name",label:"Name",sortable:!0},{key:"ip",label:"Local IP",sortable:!0},{key:"port",label:"Port",sortable:!0},{key:"phone",label:"Phone",sortable:!0},{key:"realIP",label:"Real IP",sortable:!0},{key:"username",label:"Username"},{key:"password",label:"Password"},{key:"operator",label:"Operator",sortable:!0},{key:"lastIPChange",label:"Last IP Change",sortable:!0},{key:"uptime",label:"Uptime",sortable:!0},{key:"lastStatus",label:"Status",sortable:!0},{key:"lastLatency",label:"Latency (ms)",sortable:!0},{key:"speed",label:"Download (mb/s)",sortable:!0},{key:"upload",label:"Upload (mb/s)",sortable:!0},{key:"failures",label:"Failures",sortable:!0},{key:"actions",label:"Actions"}]}},computed:{portOptions(){const t=[...new Set(this.proxies.map(t=>t.port))],e=t.map(t=>({value:t,text:t}));return[{value:null,text:"Port"},...e]},operatorOptions(){const t=[...new Set(this.proxies.map(t=>t.operator).filter(Boolean))],e=t.map(t=>({value:t,text:t}));return[{value:null,text:"Operator"},...e]},filteredData(){const t=864e5,e=new Date,s=this.proxies.filter(t=>{let e=!0;const s=this.search.toLowerCase();if(s){const r=[t.name,t.ip,t.port,t.phone,t.operator,t.realIP,t.username];e=r.some(t=>t&&t.toLowerCase().includes(s))}return e&&this.filters.port&&(e=t.port===this.filters.port),e&&this.filters.operator&&(e=t.operator===this.filters.operator),e});return s.map(s=>{const r={...s};if(r.lastIPChange){const s=new Date(r.lastIPChange);e-s>t&&(r._rowVariant="danger");const a=Math.floor((e-s)/6e4);r.uptime=a}else r.uptime=null;return r})}},methods:{formatUptime(t){if(null===t||isNaN(t))return"-";if(t<=6)return`${t}m`;const e=Math.floor(t/1440),s=Math.floor(t%1440/60),r=t%60;let a="";return e>0&&(a+=`${e}d `),s>0&&(a+=`${s}h `),(r>0||""===a)&&(a+=`${r}m`),a.trim()},togglePasswordVisibility(){this.passwordsVisible=!this.passwordsVisible},handleProxyCreated(t){this.pendingProxy=t},handleProxyUpdated(t){this.pendingProxy=t},onNew(){this.newModalShown=!0},onImport(){this.$refs.fileInput.click()},async handleFileSelected(t){const e=t.target.files[0];if(e)try{const t=await j(e);alert(`Import finished. Imported: ${t.importedCount}, Failed: ${t.failedCount}`),this.proxies=await I()}catch(s){console.error("Failed to import proxies:",s),alert("Failed to import proxies.")}finally{t.target.value=""}},async onExport(){try{await E()}catch(t){console.error("Failed to export all proxies:",t),alert("Failed to export proxies.")}},async onExportSelected(){const t=this.selectedRows.map(t=>t.id);if(0!==t.length)try{await R(t)}catch(e){console.error("Failed to export selected proxies:",e),alert("Failed to export selected proxies.")}else alert("No proxies selected for export.")},async onVerifySelected(){const t=this.selectedRows.map(t=>t.id);if(0!==t.length)try{await $(t),alert("Proxies verified successfully"),this.proxies=await I(),this.$refs.selectableTable.clearSelected()}catch(e){console.error("Failed to verify selected proxies:",e),alert("Failed to verify selected proxies.")}else alert("No proxies selected")},async onDeleteSelected(){const t=this.selectedRows.map(t=>t.id);if(0!==t.length){if(confirm(`Are you sure you want to delete ${t.length} selected proxies?`))try{for(const e of t)await D(e)}catch(e){console.error("An error occurred during batch deletion:",e),alert("An error occurred while deleting proxies. The operation was interrupted.")}finally{this.proxies=await I(),this.$refs.selectableTable.clearSelected()}}else alert("No proxies selected")},async onVerify(t){try{await O(t.id),this.proxies=await I()}catch(e){console.error(`Failed to verify proxy ${t.id}:`,e),alert(`Failed to verify proxy ${t.ip}:${t.port}.`)}},onChange(t){this.proxyToEdit=t,this.editModalShown=!0},onReset(t){alert("Reset: "+t.ipPort)},async onDelete(t){if(confirm(`Are you sure you want to delete proxy ${t.ip}:${t.port}?`))try{await D(t.id),this.proxies=await I()}catch(e){console.error(`Failed to delete proxy ${t.id}:`,e),alert(`Failed to delete proxy ${t.ip}:${t.port}.`)}},onRowSelected(t){this.selectedRows=t},onModalHidden(){this.$nextTick(()=>{if(this.pendingProxy){const t=this.proxies.findIndex(t=>t.id===this.pendingProxy.id);-1!==t?this.$set(this.proxies,t,this.pendingProxy):this.proxies.unshift(this.pendingProxy)}this.proxyToEdit=null,this.pendingProxy=null})}},async created(){const t=await I();this.proxies=t}},q=H,J=(0,i.A)(q,_,k,!1,null,"67993caa",null),G=J.exports,K={name:"ProxyView",components:{ProxySettings:w,ProxyList:G}},Y=K,Q=(0,i.A)(Y,d,u,!1,null,null,null),W=Q.exports,X=function(){var t=this,e=t._self._c;return e("div",[e("b-cart",{staticClass:"m-2",attrs:{title:"Proxy List"}},[e("LogList")],1)],1)},Z=[],tt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"card p-3"},[e("h4",[t._v("Proxy Visit History")]),e("b-form",{staticClass:"d-flex justify-content-start flex-wrap mb-3",on:{submit:function(e){return e.preventDefault(),t.applyFilters.apply(null,arguments)}}},[e("b-form-group",{staticClass:"mr-2",attrs:{label:"Proxy","label-for":"proxy-filter"}},[e("b-form-select",{attrs:{id:"proxy-filter",options:t.proxyOptions,size:"sm"},model:{value:t.filters.proxy_id,callback:function(e){t.$set(t.filters,"proxy_id",e)},expression:"filters.proxy_id"}})],1),e("b-form-group",{staticClass:"mr-2",attrs:{label:"Source IP","label-for":"source-ip-filter"}},[e("b-form-input",{attrs:{id:"source-ip-filter",size:"sm",placeholder:"Enter Source IP"},model:{value:t.filters.source_ip,callback:function(e){t.$set(t.filters,"source_ip",e)},expression:"filters.source_ip"}})],1),e("b-form-group",{staticClass:"mr-2",attrs:{label:"Domain","label-for":"domain-filter"}},[e("b-form-input",{attrs:{id:"domain-filter",size:"sm",placeholder:"Enter Domain"},model:{value:t.filters.domain,callback:function(e){t.$set(t.filters,"domain",e)},expression:"filters.domain"}})],1),e("b-form-group",{staticClass:"mr-2",attrs:{label:"Start Date","label-for":"start-date-filter"}},[e("b-form-datepicker",{attrs:{id:"start-date-filter",size:"sm"},model:{value:t.filters.start_date,callback:function(e){t.$set(t.filters,"start_date",e)},expression:"filters.start_date"}})],1),e("b-form-group",{staticClass:"mr-2",attrs:{label:"End Date","label-for":"end-date-filter"}},[e("b-form-datepicker",{attrs:{id:"end-date-filter",size:"sm"},model:{value:t.filters.end_date,callback:function(e){t.$set(t.filters,"end_date",e)},expression:"filters.end_date"}})],1),e("div",{staticClass:"d-flex align-items-end"},[e("b-button",{staticClass:"mr-2",attrs:{type:"submit",variant:"primary",size:"sm"}},[t._v("Apply")]),e("b-button",{attrs:{variant:"secondary",size:"sm"},on:{click:t.resetFilters}},[t._v("Reset")])],1)],1),e("b-table",{attrs:{items:t.logs,fields:t.fields,busy:t.isBusy,small:"",responsive:"sm"},on:{"update:busy":function(e){t.isBusy=e},"sort-changed":t.handleSort},scopedSlots:t._u([{key:"cell(proxy_name)",fn:function({item:e}){return[t._v(t._s(t.getProxyName(e.proxy_id)))]}},{key:"cell(timestamp)",fn:function({value:e}){return[t._v(t._s(new Date(e).toLocaleString()))]}}])}),e("div",{staticClass:"d-flex justify-content-between align-items-center mt-3"},[e("small",[t._v(t._s(t.totalRows)+" results")]),e("b-pagination",{attrs:{"total-rows":t.totalRows,"per-page":t.perPage,size:"sm"},on:{change:t.handlePageChange},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1)},et=[],st=(s(4114),s(116),{name:"ProxyVisitLogList",data(){return{logs:[],isBusy:!1,filters:{proxy_id:null,source_ip:"",domain:"",start_date:"",end_date:""},proxyOptions:[{value:null,text:"All Proxies"}],currentPage:1,perPage:15,totalRows:0,sortBy:"timestamp",sortDesc:!0,fields:[{key:"proxy_name",label:"Proxy Name",sortable:!1},{key:"timestamp",label:"Date/Time",sortable:!0},{key:"source_ip",label:"Source IP",sortable:!0},{key:"target_ip",label:"Target IP",sortable:!0},{key:"domain",label:"Domain",sortable:!0}]}},async created(){const t=this.$route.query.proxy_id;t&&(this.filters.proxy_id=t),await this.loadProxies(),await this.fetchLogs()},methods:{async fetchLogs(){this.isBusy=!0;try{const t={page:this.currentPage,page_size:this.perPage,sort_field:this.sortBy,sort_desc:this.sortDesc,...this.filters};Object.keys(t).forEach(e=>{null!==t[e]&&""!==t[e]||delete t[e]});const{data:e,total:s}=await A(t);this.logs=e,this.totalRows=s}catch(t){alert("Failed to load proxy visit logs.")}finally{this.isBusy=!1}},getProxyName(t){const e=this.proxyOptions.find(e=>e.value===t);return e?e.text:"Unknown"},async loadProxies(){try{const t=await I();this.proxyOptions.push(...t.map(t=>({value:t.id,text:t.name})))}catch(t){console.error("Failed to load proxies for filter:",t)}},applyFilters(){this.currentPage=1,this.fetchLogs()},resetFilters(){this.filters={proxy_id:null,source_ip:"",domain:"",start_date:"",end_date:""},this.applyFilters()},handlePageChange(t){this.currentPage=t,this.fetchLogs()},handleSort(t){this.sortBy=t.sortBy,this.sortDesc=t.sortDesc,this.currentPage=1,this.fetchLogs()}}}),rt=st,at=(0,i.A)(rt,tt,et,!1,null,"7420731e",null),ot=at.exports,it={name:"LogView",components:{LogList:ot}},nt=it,lt=(0,i.A)(nt,X,Z,!1,null,null,null),ct=lt.exports,pt=function(){var t=this,e=t._self._c;return e("div",[e("b-card",{staticClass:"m-2",attrs:{title:"Speed History"}},[e("SpeedLogList")],1)],1)},dt=[],ut=function(){var t=this,e=t._self._c;return e("div",{staticClass:"card p-3"},[e("b-form",{staticClass:"d-flex justify-content-start flex-wrap mb-3",on:{submit:function(e){return e.preventDefault(),t.applyFilters.apply(null,arguments)}}},[e("b-form-group",{staticClass:"mr-2",attrs:{label:"Proxy","label-for":"proxy-filter"}},[e("b-form-select",{attrs:{id:"proxy-filter",options:t.proxyOptions,size:"sm"},model:{value:t.filters.proxy_id,callback:function(e){t.$set(t.filters,"proxy_id",e)},expression:"filters.proxy_id"}})],1),e("b-form-group",{staticClass:"mr-2",attrs:{label:"Start Date","label-for":"start-date-filter"}},[e("b-form-datepicker",{attrs:{id:"start-date-filter",size:"sm"},model:{value:t.filters.start_date,callback:function(e){t.$set(t.filters,"start_date",e)},expression:"filters.start_date"}})],1),e("b-form-group",{staticClass:"mr-2",attrs:{label:"End Date","label-for":"end-date-filter"}},[e("b-form-datepicker",{attrs:{id:"end-date-filter",size:"sm"},model:{value:t.filters.end_date,callback:function(e){t.$set(t.filters,"end_date",e)},expression:"filters.end_date"}})],1),e("div",{staticClass:"d-flex align-items-end"},[e("b-button",{staticClass:"mr-2",attrs:{type:"submit",variant:"primary",size:"sm"}},[t._v("Apply")]),e("b-button",{attrs:{variant:"secondary",size:"sm"},on:{click:t.resetFilters}},[t._v("Reset")])],1)],1),e("b-table",{attrs:{items:t.logs,fields:t.fields,busy:t.isBusy,small:"",responsive:"sm"},on:{"update:busy":function(e){t.isBusy=e},"sort-changed":t.handleSort},scopedSlots:t._u([{key:"cell(proxy_name)",fn:function({item:e}){return[t._v(t._s(t.getProxyName(e.proxy_id)))]}},{key:"cell(timestamp)",fn:function({value:e}){return[t._v(t._s(new Date(e).toLocaleString()))]}},{key:"cell(speed)",fn:function({value:e}){return[t._v(t._s(e)+" KB/s")]}}])}),e("div",{staticClass:"d-flex justify-content-between align-items-center mt-3"},[e("small",[t._v(t._s(t.totalRows)+" results")]),e("b-pagination",{attrs:{"total-rows":t.totalRows,"per-page":t.perPage,size:"sm"},on:{change:t.handlePageChange},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1)},ft=[],ht={name:"SpeedLogList",data(){return{logs:[],isBusy:!1,filters:{proxy_id:null,start_date:"",end_date:""},proxyOptions:[{value:null,text:"All Proxies"}],currentPage:1,perPage:15,totalRows:0,sortBy:"timestamp",sortDesc:!0,fields:[{key:"proxy_name",label:"Proxy Name",sortable:!1},{key:"timestamp",label:"Date/Time",sortable:!0},{key:"speed",label:"Speed",sortable:!0}]}},async created(){const t=this.$route.query.proxy_id;t&&(this.filters.proxy_id=t),await this.loadProxies(),await this.fetchLogs()},methods:{async fetchLogs(){this.isBusy=!0;try{const t={page:this.currentPage,page_size:this.perPage,sort_field:this.sortBy,sort_desc:this.sortDesc,...this.filters};Object.keys(t).forEach(e=>{null!==t[e]&&""!==t[e]||delete t[e]});const{data:e,total:s}=await B(t);this.logs=e,this.totalRows=s}catch(t){alert("Failed to load speed logs.")}finally{this.isBusy=!1}},getProxyName(t){const e=this.proxyOptions.find(e=>e.value===t);return e?e.text:"Unknown"},async loadProxies(){try{const t=await I();this.proxyOptions.push(...t.map(t=>({value:t.id,text:t.name})))}catch(t){console.error("Failed to load proxies for filter:",t)}},applyFilters(){this.currentPage=1,this.fetchLogs()},resetFilters(){this.filters={proxy_id:null,start_date:"",end_date:""},this.applyFilters()},handlePageChange(t){this.currentPage=t,this.fetchLogs()},handleSort(t){this.sortBy=t.sortBy,this.sortDesc=t.sortDesc,this.currentPage=1,this.fetchLogs()}}},mt=ht,yt=(0,i.A)(mt,ut,ft,!1,null,"7b631966",null),bt=yt.exports,gt={name:"SpeedLogView",components:{SpeedLogList:bt}},xt=gt,vt=(0,i.A)(xt,pt,dt,!1,null,null,null),wt=vt.exports,_t=function(){var t=this,e=t._self._c;return e("div",[e("b-card",{staticClass:"m-2",attrs:{title:"IP Change History"}},[e("IpLogList")],1)],1)},kt=[],Pt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"card p-3"},[e("h4",[t._v("IP Change History")]),e("b-form",{staticClass:"d-flex justify-content-start flex-wrap mb-3",on:{submit:function(e){return e.preventDefault(),t.applyFilters.apply(null,arguments)}}},[e("b-form-group",{staticClass:"mr-2",attrs:{label:"Proxy","label-for":"proxy-filter"}},[e("b-form-select",{attrs:{id:"proxy-filter",options:t.proxyOptions,size:"sm"},model:{value:t.filters.proxy_id,callback:function(e){t.$set(t.filters,"proxy_id",e)},expression:"filters.proxy_id"}})],1),e("b-form-group",{staticClass:"mr-2",attrs:{label:"Start Date","label-for":"start-date-filter"}},[e("b-form-datepicker",{attrs:{id:"start-date-filter",size:"sm"},model:{value:t.filters.start_date,callback:function(e){t.$set(t.filters,"start_date",e)},expression:"filters.start_date"}})],1),e("b-form-group",{staticClass:"mr-2",attrs:{label:"End Date","label-for":"end-date-filter"}},[e("b-form-datepicker",{attrs:{id:"end-date-filter",size:"sm"},model:{value:t.filters.end_date,callback:function(e){t.$set(t.filters,"end_date",e)},expression:"filters.end_date"}})],1),e("div",{staticClass:"d-flex align-items-end"},[e("b-button",{staticClass:"mr-2",attrs:{type:"submit",variant:"primary",size:"sm"}},[t._v("Apply")]),e("b-button",{attrs:{variant:"secondary",size:"sm"},on:{click:t.resetFilters}},[t._v("Reset")])],1)],1),e("b-table",{attrs:{items:t.logs,fields:t.fields,busy:t.isBusy,small:"",responsive:"sm"},on:{"update:busy":function(e){t.isBusy=e},"sort-changed":t.handleSort},scopedSlots:t._u([{key:"cell(proxy_name)",fn:function({item:e}){return[t._v(t._s(t.getProxyName(e.proxy_id)))]}},{key:"cell(timestamp)",fn:function({value:e}){return[t._v(t._s(new Date(e).toLocaleString()))]}}])}),e("div",{staticClass:"d-flex justify-content-between align-items-center mt-3"},[e("small",[t._v(t._s(t.totalRows)+" results")]),e("b-pagination",{attrs:{"total-rows":t.totalRows,"per-page":t.perPage,size:"sm"},on:{change:t.handlePageChange},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1)},St=[],Ct={name:"IpLogList",data(){return{logs:[],isBusy:!1,filters:{proxy_id:null,start_date:"",end_date:""},proxyOptions:[{value:null,text:"All Proxies"}],currentPage:1,perPage:15,totalRows:0,sortBy:"timestamp",sortDesc:!0,fields:[{key:"proxy_name",label:"Proxy Name",sortable:!1},{key:"timestamp",label:"Date/Time",sortable:!0},{key:"ip",label:"New IP",sortable:!0},{key:"old_ip",label:"Old IP",sortable:!1},{key:"isp",label:"ISP",sortable:!0}]}},async created(){const t=this.$route.query.proxy_id;t&&(this.filters.proxy_id=t),await this.loadProxies(),await this.fetchLogs()},methods:{async fetchLogs(){this.isBusy=!0;try{const t={page:this.currentPage,page_size:this.perPage,sort_field:this.sortBy,sort_desc:this.sortDesc,...this.filters};Object.keys(t).forEach(e=>{null!==t[e]&&""!==t[e]||delete t[e]});const{data:e,total:s}=await T(t);this.logs=e,this.totalRows=s}catch(t){alert("Failed to load IP logs.")}finally{this.isBusy=!1}},getProxyName(t){const e=this.proxyOptions.find(e=>e.value===t);return e?e.text:"Unknown"},async loadProxies(){try{const t=await I();this.proxyOptions.push(...t.map(t=>({value:t.id,text:t.name}))),console.log("Loaded proxies:",t)}catch(t){console.error("Failed to load proxies for filter:",t)}},applyFilters(){this.currentPage=1,this.fetchLogs()},resetFilters(){this.filters={proxy_id:null,start_date:"",end_date:""},this.applyFilters()},handlePageChange(t){this.currentPage=t,this.fetchLogs()},handleSort(t){this.sortBy=t.sortBy,this.sortDesc=t.sortDesc,this.currentPage=1,this.fetchLogs()}}},It=Ct,Lt=(0,i.A)(It,Pt,St,!1,null,"781ee272",null),Ft=Lt.exports,Dt={name:"IpLogView",components:{IpLogList:Ft}},Ot=Dt,$t=(0,i.A)(Ot,_t,kt,!1,null,null,null),jt=$t.exports;r["default"].use(p.Ay);const zt=[{path:"/",name:"proxy",component:W},{path:"/visit_logs",name:"visit_logs",component:ct},{path:"/speed_logs",name:"speed_logs",component:wt},{path:"/ip_logs",name:"ip_logs",component:jt}],Et=new p.Ay({mode:"history",base:"/",routes:zt});var Rt=Et,Bt=(s(9313),s(1501)),Tt=s(7673);r["default"].config.productionTip=!1,r["default"].use(Bt.vGs),r["default"].use(Tt.YS),new r["default"]({router:Rt,render:t=>t(c)}).$mount("#app")}},e={};function s(r){var a=e[r];if(void 0!==a)return a.exports;var o=e[r]={exports:{}};return t[r].call(o.exports,o,o.exports,s),o.exports}s.m=t,function(){var t=[];s.O=function(e,r,a,o){if(!r){var i=1/0;for(p=0;p<t.length;p++){r=t[p][0],a=t[p][1],o=t[p][2];for(var n=!0,l=0;l<r.length;l++)(!1&o||i>=o)&&Object.keys(s.O).every(function(t){return s.O[t](r[l])})?r.splice(l--,1):(n=!1,o<i&&(i=o));if(n){t.splice(p--,1);var c=a();void 0!==c&&(e=c)}}return e}o=o||0;for(var p=t.length;p>0&&t[p-1][2]>o;p--)t[p]=t[p-1];t[p]=[r,a,o]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var r in e)s.o(e,r)&&!s.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={524:0};s.O.j=function(e){return 0===t[e]};var e=function(e,r){var a,o,i=r[0],n=r[1],l=r[2],c=0;if(i.some(function(e){return 0!==t[e]})){for(a in n)s.o(n,a)&&(s.m[a]=n[a]);if(l)var p=l(s)}for(e&&e(r);c<i.length;c++)o=i[c],s.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return s.O(p)},r=self["webpackChunkclient"]=self["webpackChunkclient"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var r=s.O(void 0,[504],function(){return s(9210)});r=s.O(r)})();
//# sourceMappingURL=app.2232daec.js.map